buildPack: none
pipelineConfig:
  pipelines:
    pullRequest:
      pipeline:
        agent:
          image: gcr.io/jenkinsxio/builder-terraform:2.0.1075-406
        stages:
        - name: ci
          steps:
          - name: terraform-version
            command: terraform
            args:
            - -version
          - name: terraform-init
            command: terraform
            args:
            - init
          - name: terraform-fmt
            command: terraform
            args:
            - fmt
            - -check
          - name: terraform-validate
            command: terraform
            args:
            - validate
          - name: find-pwd
            command: pwd
          - name: terraform-plan
            command: terraform
            args:
            - plan
            - >
            - /workspace/source/plan.txt
          - name: cat-terraform-plan
            command: cat
            args:
            - /workspace/source/plan.txt
          - name: comment
            command: jx
            args:
            - step
            - pr
            - comment
            - --comment="running terraform plan"
